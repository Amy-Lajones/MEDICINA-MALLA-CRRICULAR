<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Malla Curricular Medicina</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f6f9;
      margin: 0;
      padding: 1rem;
    }
    h1 {
      text-align: center;
      color: #34495e;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(11, 1fr);
      gap: 1rem;
      margin-top: 2rem;
      overflow-x: auto;
    }
    .column {
      background: #ecf0f1;
      padding: 0.5rem;
      border-radius: 10px;
      min-width: 200px;
    }
    .column h2 {
      text-align: center;
      font-size: 1.1rem;
      color: #2c3e50;
    }
    .subject {
      background: #ffffff;
      border: 1px solid #bdc3c7;
      border-radius: 6px;
      padding: 0.4rem;
      margin: 0.4rem 0;
      cursor: pointer;
      position: relative;
      user-select: none;
      transition: background-color 0.2s;
    }
    .subject.locked {
      background: #e0e0e0;
      color: #999;
      cursor: not-allowed;
    }
    .subject.locked::after {
      content: attr(data-tooltip);
      position: absolute;
      left: 100%;
      top: 50%;
      transform: translateY(-50%);
      background: #34495e;
      color: white;
      padding: 0.3rem 0.6rem;
      border-radius: 5px;
      font-size: 0.8rem;
      white-space: nowrap;
      display: none;
    }
    .subject.locked:hover::after {
      display: block;
    }
    .subject.approved {
      background-color: #a2d5ab;
      text-decoration: line-through;
    }
    .components {
      margin-top: 3rem;
      background-color: #e8f0fe;
      padding: 1rem;
      border-radius: 10px;
    }
    .components h2 {
      color: #1a73e8;
    }
    .components ul {
      list-style: none;
      padding-left: 0;
    }
    .components li {
      margin: 0.5rem 0;
      padding: 0.5rem;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      cursor: pointer;
    }
    .components li.approved {
      background-color: #a2d5ab;
      text-decoration: line-through;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Medicina</h1>
  <div class="grid" id="malla"></div>

  <div class="components">
    <h2>Componentes Adicionales</h2>
    <ul id="componentes">
      <li data-id="comp1">Computación I</li>
      <li data-id="comp2">Computación II</li>
      <li data-id="comp3">Computación III</li>
      <li data-id="ing1">Inglés I</li>
      <li data-id="ing2">Inglés II</li>
      <li data-id="ing3">Inglés III</li>
      <li data-id="ing4">Inglés IV</li>
      <li data-id="inte">Unidad de integración curricular</li>
    </ul>
  </div>

  <script>
    const subjects = [
      { id: "1", name: "Anatomía I", semester: 1, prereqs: [] },
      { id: "2", name: "Embriología", semester: 1, prereqs: [] },
      { id: "3", name: "Biología Celular", semester: 1, prereqs: [] },
      { id: "4", name: "Histología", semester: 1, prereqs: [] },
      { id: "5", name: "Biofísica", semester: 1, prereqs: [] },
      { id: "6", name: "Lenguaje y Comunicación", semester: 1, prereqs: [] },
      { id: "7", name: "Anatomía II", semester: 2, prereqs: ["1"] },
      { id: "8", name: "Biología Molecular", semester: 2, prereqs: ["2","3"] },
      { id: "9", name: "Neuroanatomía", semester: 2, prereqs: ["1"] },
      { id: "10", name: "APS y Promoción de Salud", semester: 2, prereqs: [] },
      { id: "11", name: "Salud Pública I", semester: 2, prereqs: ["3"] },
      { id: "12", name: "Metodología de la Investigación I", semester: 2, prereqs: ["6"] },
      { id: "13", name: "Bioquímica I", semester: 3, prereqs: ["8"] },
      { id: "14", name: "Bacteriología", semester: 3, prereqs: ["8"] },
      { id: "15", name: "Micología", semester: 3, prereqs: ["8"] },
      { id: "16", name: "Fisiología I", semester: 3, prereqs: ["4","7","8"] },
      { id: "17", name: "Parasitología", semester: 3, prereqs: ["8"] },
      { id: "18", name: "Bioestadística", semester: 3, prereqs: ["12"] },
      { id: "19", name: "Anatomía Patológica", semester: 4, prereqs: [] },
      { id: "20", name: "Bioquímica II", semester: 4, prereqs: ["8","13"] },
      { id: "21", name: "Fisiología II", semester: 4, prereqs: ["16"] },
      { id: "22", name: "Psicología", semester: 4, prereqs: ["6"] },
      { id: "23", name: "Virología", semester: 4, prereqs: ["8"] },
      { id: "24", name: "Bioética", semester: 4, prereqs: ["4"] },
      { id: "25", name: "Fisiopatología", semester: 5, prereqs: ["21"] },
      { id: "26", name: "Imagenología", semester: 5, prereqs: ["7"] },
      { id: "27", name: "Semiología I", semester: 5, prereqs: ["7","21"] },
      { id: "28", name: "Nutrición", semester: 5, prereqs: ["20","21"] },
      { id: "29", name: "Epidemiología", semester: 5, prereqs: ["10"] },
      { id: "30", name: "Metodología de Investigación II", semester: 5, prereqs: ["18"] },
      { id: "31", name: "Patologías Infecciosas", semester: 6, prereqs: ["14","15","23"] },
      { id: "32", name: "Farmacología Preclínica", semester: 6, prereqs: ["20","21"] },
      { id: "33", name: "Semiología II", semester: 6, prereqs: ["27"] },
      { id: "34", name: "Medicina Legal", semester: 6, prereqs: ["27"] },
      { id: "35", name: "Inmunología", semester: 6, prereqs: ["8"] },
      { id: "36", name: "Clínica I", semester: 7, prereqs: ["33"] },
      { id: "37", name: "Endocrinología", semester: 7, prereqs: ["33"] },
      { id: "38", name: "Cardiología", semester: 7, prereqs: ["33"] },
      { id: "39", name: "Psiquiatría", semester: 7, prereqs: ["22"] },
      { id: "40", name: "Oncología", semester: 7, prereqs: ["33"] },
      { id: "41", name: "Salud Pública II", semester: 7, prereqs: ["10"] },
      { id: "42", name: "Farmacología Clínica", semester: 7, prereqs: ["32"] },
      { id: "43", name: "Clínica II", semester: 8, prereqs: ["36"] },
      { id: "44", name: "Genética Clínica", semester: 8, prereqs: ["8"] },
      { id: "45", name: "Hematología", semester: 8, prereqs: ["36"] },
      { id: "46", name: "Neurología", semester: 8, prereqs: ["36"] },
      { id: "47", name: "Neumología", semester: 8, prereqs: ["36"] },
      { id: "48", name: "Salud Familiar y Comunitaria", semester: 8, prereqs: ["10"] },
      { id: "49", name: "Geriatría", semester: 8, prereqs: ["36"] },
      { id: "50", name: "Pediatría I", semester: 9, prereqs: ["43"] },
      { id: "51", name: "Cirugía I", semester: 9, prereqs: ["7"] },
      { id: "52", name: "Ginecoobstetricia I", semester: 9, prereqs: ["43"] },
      { id: "53", name: "Dermatología", semester: 9, prereqs: ["43"] },
      { id: "54", name: "Urología", semester: 9, prereqs: ["43"] },
      { id: "55", name: "Nefrología", semester: 9, prereqs: ["43"] },
      { id: "56", name: "Elaboración de Proyectos", semester: 9, prereqs: ["30"] },
      { id: "57", name: "Pediatría II", semester: 10, prereqs: ["43","50"] },
      { id: "58", name: "Cirugía II", semester: 10, prereqs: ["51"] },
      { id: "59", name: "Ginecoobstetricia II", semester: 10, prereqs: ["52"] },
      { id: "60", name: "Otorrinolaringología", semester: 10, prereqs: ["51"] },
      { id: "61", name: "Oftalmología", semester: 10, prereqs: ["51"] },
      { id: "62", name: "Traumatología", semester: 10, prereqs: ["51"] },
      { id: "63", name: "Internado: Medicina Interna", semester: 11, prereqs: ["57"] },
      { id: "64", name: "Internado: Cirugía", semester: 11, prereqs: ["58"] },
      { id: "65", name: "Internado: Ginecoobstetricia", semester: 11, prereqs: ["59"] },
      { id: "66", name: "Internado: Pediatría", semester: 11, prereqs: ["57"] },
      { id: "67", name: "Internado: Medicina Comunitaria", semester: 11, prereqs: ["48"] }
    ];

    const componentes = [
      { id: "comp1", name: "Computación I" },
      { id: "comp2", name: "Computación II" },
      { id: "comp3", name: "Computación III" },
      { id: "ing1", name: "Inglés I" },
      { id: "ing2", name: "Inglés II" },
      { id: "ing3", name: "Inglés III" },
      { id: "ing4", name: "Inglés IV" },
      { id: "inte", name: "Unidad de integración curricular" }
    ];

    const approved = new Set(JSON.parse(localStorage.getItem("aprobadas") || "[]"));

    function saveProgress() {
      localStorage.setItem("aprobadas", JSON.stringify([...approved]));
    }

    function createMalla() {
      const container = document.getElementById("malla");
      for (let i = 1; i <= 11; i++) {
        const col = document.createElement("div");
        col.className = "column";
        const title = document.createElement("h2");
        title.textContent = `Semestre ${i}`;
        col.appendChild(title);

        subjects.filter(s => s.semester === i).forEach(subject => {
          const div = document.createElement("div");
          div.className = "subject";
          div.textContent = subject.name;
          div.dataset.id = subject.id;

          const missing = subject.prereqs.filter(p => !approved.has(p));
          if (missing.length) {
            div.classList.add("locked");
            const missingNames = missing.map(m => {
              const found = subjects.find(s => s.id === m);
              return found ? found.name : m;
            });
            div.dataset.tooltip = `Falta: ${missingNames.join(", ")}`;
          } else {
            if (approved.has(subject.id)) {
              div.classList.add("approved");
            }
            div.addEventListener("click", () => {
              if (div.classList.contains("approved")) {
                approved.delete(subject.id);
                div.classList.remove("approved");
              } else {
                approved.add(subject.id);
                div.classList.add("approved");
              }
              saveProgress();
              location.reload();
            });
          }

          col.appendChild(div);
        });

        container.appendChild(col);
      }
    }

    function createComponentes() {
      const ul = document.getElementById("componentes");
      ul.querySelectorAll("li").forEach(li => {
        const id = li.dataset.id;
        if (approved.has(id)) {
          li.classList.add("approved");
        }
        li.addEventListener("click", () => {
          if (approved.has(id)) {
            approved.delete(id);
            li.classList.remove("approved");
          } else {
            approved.add(id);
            li.classList.add("approved");
          }
          saveProgress();
        });
      });
    }

    createMalla();
    createComponentes();
  </script>
</body>
</html>
